interactions:
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-type:
      - application/json
      User-Agent:
      - PyIceberg/0.9.1
      X-Client-Version:
      - 0.14.1
      X-Iceberg-Access-Delegation:
      - vended-credentials
    method: GET
    uri: https://iceberg-test.ohsome.org/v1/config
  response:
    body:
      string: '{"defaults":{},"overrides":{}}'
    headers:
      Connection:
      - Keep-Alive
      Content-Length:
      - '30'
      Content-Type:
      - application/json
      Date:
      - Fri, 17 Oct 2025 10:18:44 GMT
      Keep-Alive:
      - timeout=5, max=100
      Server:
      - Jetty(9.4.51.v20230217)
      Strict-Transport-Security:
      - max-age=63072000; includeSubdomains;
      Vary:
      - Accept-Encoding,User-Agent
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-type:
      - application/json
      User-Agent:
      - PyIceberg/0.9.1
      X-Client-Version:
      - 0.14.1
      X-Iceberg-Access-Delegation:
      - vended-credentials
    method: GET
    uri: https://iceberg-test.ohsome.org/v1/namespaces/geo_sort/tables/contributions
  response:
    body:
      string: '{"metadata-location":"s3a://heigit-ohsome-planet/iceberg/geo_sort/contributions/metadata/00002-c96f8645-6fa7-4e5b-9392-6c8694467bef.metadata.json","metadata":{"format-version":2,"table-uuid":"ef30d2be-61ab-4431-88db-d85d8f579b77","location":"s3a://heigit-ohsome-planet/iceberg/geo_sort/contributions","last-sequence-number":1,"last-updated-ms":1725696468364,"last-column-id":84,"current-schema-id":0,"schemas":[{"type":"struct","schema-id":0,"fields":[{"id":1,"name":"user_id","required":false,"type":"int"},{"id":2,"name":"valid_from","required":false,"type":"timestamp"},{"id":3,"name":"valid_to","required":false,"type":"timestamp"},{"id":4,"name":"osm_type","required":false,"type":"string"},{"id":5,"name":"osm_id","required":false,"type":"string"},{"id":6,"name":"osm_version","required":false,"type":"int"},{"id":7,"name":"contrib_type","required":false,"type":"string"},{"id":8,"name":"members","required":false,"type":{"type":"list","element-id":31,"element":{"type":"struct","fields":[{"id":32,"name":"type","required":false,"type":"string"},{"id":33,"name":"id","required":false,"type":"long"},{"id":34,"name":"role","required":false,"type":"string"},{"id":35,"name":"geometry","required":false,"type":"binary"}]},"element-required":false}},{"id":9,"name":"status","required":false,"type":"string"},{"id":10,"name":"changeset","required":false,"type":{"type":"struct","fields":[{"id":36,"name":"id","required":false,"type":"long"},{"id":37,"name":"timestamp","required":false,"type":"timestamp"},{"id":38,"name":"tags","required":false,"type":{"type":"map","key-id":41,"key":"string","value-id":42,"value":"string","value-required":false}},{"id":39,"name":"hashtags","required":false,"type":{"type":"list","element-id":43,"element":"string","element-required":false}},{"id":40,"name":"editor","required":false,"type":"string"}]}},{"id":11,"name":"tags","required":false,"type":{"type":"map","key-id":44,"key":"string","value-id":45,"value":"string","value-required":false}},{"id":12,"name":"tags_before","required":false,"type":{"type":"map","key-id":46,"key":"string","value-id":47,"value":"string","value-required":false}},{"id":13,"name":"map_features","required":false,"type":{"type":"struct","fields":[{"id":48,"name":"aerialway","required":false,"type":"boolean"},{"id":49,"name":"aeroway","required":false,"type":"boolean"},{"id":50,"name":"amenity","required":false,"type":"boolean"},{"id":51,"name":"barrier","required":false,"type":"boolean"},{"id":52,"name":"boundary","required":false,"type":"boolean"},{"id":53,"name":"building","required":false,"type":"boolean"},{"id":54,"name":"craft","required":false,"type":"boolean"},{"id":55,"name":"emergency","required":false,"type":"boolean"},{"id":56,"name":"geological","required":false,"type":"boolean"},{"id":57,"name":"healthcare","required":false,"type":"boolean"},{"id":58,"name":"highway","required":false,"type":"boolean"},{"id":59,"name":"historic","required":false,"type":"boolean"},{"id":60,"name":"landuse","required":false,"type":"boolean"},{"id":61,"name":"leisure","required":false,"type":"boolean"},{"id":62,"name":"man_made","required":false,"type":"boolean"},{"id":63,"name":"military","required":false,"type":"boolean"},{"id":64,"name":"natural","required":false,"type":"boolean"},{"id":65,"name":"office","required":false,"type":"boolean"},{"id":66,"name":"place","required":false,"type":"boolean"},{"id":67,"name":"power","required":false,"type":"boolean"},{"id":68,"name":"public_transport","required":false,"type":"boolean"},{"id":69,"name":"railway","required":false,"type":"boolean"},{"id":70,"name":"route","required":false,"type":"boolean"},{"id":71,"name":"shop","required":false,"type":"boolean"},{"id":72,"name":"sport","required":false,"type":"boolean"},{"id":73,"name":"telecom","required":false,"type":"boolean"},{"id":74,"name":"water","required":false,"type":"boolean"},{"id":75,"name":"waterway","required":false,"type":"boolean"}]}},{"id":14,"name":"area","required":false,"type":"long"},{"id":15,"name":"area_delta","required":false,"type":"long"},{"id":16,"name":"length","required":false,"type":"long"},{"id":17,"name":"length_delta","required":false,"type":"long"},{"id":18,"name":"xzcode","required":false,"type":{"type":"struct","fields":[{"id":76,"name":"level","required":false,"type":"int"},{"id":77,"name":"code","required":false,"type":"long"}]}},{"id":19,"name":"country_iso_a3","required":false,"type":{"type":"list","element-id":78,"element":"string","element-required":false}},{"id":20,"name":"bbox","required":false,"type":{"type":"struct","fields":[{"id":79,"name":"xmin","required":false,"type":"double"},{"id":80,"name":"ymin","required":false,"type":"double"},{"id":81,"name":"xmax","required":false,"type":"double"},{"id":82,"name":"ymax","required":false,"type":"double"}]}},{"id":21,"name":"xmin","required":false,"type":"double"},{"id":22,"name":"xmax","required":false,"type":"double"},{"id":23,"name":"ymin","required":false,"type":"double"},{"id":24,"name":"ymax","required":false,"type":"double"},{"id":25,"name":"centroid","required":false,"type":{"type":"struct","fields":[{"id":83,"name":"x","required":false,"type":"double"},{"id":84,"name":"y","required":false,"type":"double"}]}},{"id":26,"name":"quadkey_z10","required":false,"type":"string"},{"id":27,"name":"h3_r5","required":false,"type":"long"},{"id":28,"name":"geometry_type","required":false,"type":"string"},{"id":29,"name":"geometry_valid","required":false,"type":"boolean"},{"id":30,"name":"geometry","required":false,"type":"string"}]}],"default-spec-id":0,"partition-specs":[{"spec-id":0,"fields":[{"name":"status","transform":"identity","source-id":9,"field-id":1000},{"name":"geometry_type","transform":"identity","source-id":28,"field-id":1001}]}],"last-partition-id":1001,"default-sort-order-id":0,"sort-orders":[{"order-id":0,"fields":[]}],"properties":{"schema.name-mapping.default":"[
        {\n  \"field-id\" : 1,\n  \"names\" : [ \"user_id\" ]\n}, {\n  \"field-id\"
        : 2,\n  \"names\" : [ \"valid_from\" ]\n}, {\n  \"field-id\" : 3,\n  \"names\"
        : [ \"valid_to\" ]\n}, {\n  \"field-id\" : 4,\n  \"names\" : [ \"osm_type\"
        ]\n}, {\n  \"field-id\" : 5,\n  \"names\" : [ \"osm_id\" ]\n}, {\n  \"field-id\"
        : 6,\n  \"names\" : [ \"osm_version\" ]\n}, {\n  \"field-id\" : 7,\n  \"names\"
        : [ \"contrib_type\" ]\n}, {\n  \"field-id\" : 8,\n  \"names\" : [ \"members\"
        ],\n  \"fields\" : [ {\n    \"field-id\" : 31,\n    \"names\" : [ \"element\"
        ],\n    \"fields\" : [ {\n      \"field-id\" : 32,\n      \"names\" : [ \"type\"
        ]\n    }, {\n      \"field-id\" : 33,\n      \"names\" : [ \"id\" ]\n    },
        {\n      \"field-id\" : 34,\n      \"names\" : [ \"role\" ]\n    }, {\n      \"field-id\"
        : 35,\n      \"names\" : [ \"geometry\" ]\n    } ]\n  } ]\n}, {\n  \"field-id\"
        : 9,\n  \"names\" : [ \"status\" ]\n}, {\n  \"field-id\" : 10,\n  \"names\"
        : [ \"changeset\" ],\n  \"fields\" : [ {\n    \"field-id\" : 36,\n    \"names\"
        : [ \"id\" ]\n  }, {\n    \"field-id\" : 37,\n    \"names\" : [ \"timestamp\"
        ]\n  }, {\n    \"field-id\" : 38,\n    \"names\" : [ \"tags\" ],\n    \"fields\"
        : [ {\n      \"field-id\" : 41,\n      \"names\" : [ \"key\" ]\n    }, {\n      \"field-id\"
        : 42,\n      \"names\" : [ \"value\" ]\n    } ]\n  }, {\n    \"field-id\"
        : 39,\n    \"names\" : [ \"hashtags\" ],\n    \"fields\" : [ {\n      \"field-id\"
        : 43,\n      \"names\" : [ \"element\" ]\n    } ]\n  }, {\n    \"field-id\"
        : 40,\n    \"names\" : [ \"editor\" ]\n  } ]\n}, {\n  \"field-id\" : 11,\n  \"names\"
        : [ \"tags\" ],\n  \"fields\" : [ {\n    \"field-id\" : 44,\n    \"names\"
        : [ \"key\" ]\n  }, {\n    \"field-id\" : 45,\n    \"names\" : [ \"value\"
        ]\n  } ]\n}, {\n  \"field-id\" : 12,\n  \"names\" : [ \"tags_before\" ],\n  \"fields\"
        : [ {\n    \"field-id\" : 46,\n    \"names\" : [ \"key\" ]\n  }, {\n    \"field-id\"
        : 47,\n    \"names\" : [ \"value\" ]\n  } ]\n}, {\n  \"field-id\" : 13,\n  \"names\"
        : [ \"map_features\" ],\n  \"fields\" : [ {\n    \"field-id\" : 48,\n    \"names\"
        : [ \"aerialway\" ]\n  }, {\n    \"field-id\" : 49,\n    \"names\" : [ \"aeroway\"
        ]\n  }, {\n    \"field-id\" : 50,\n    \"names\" : [ \"amenity\" ]\n  }, {\n    \"field-id\"
        : 51,\n    \"names\" : [ \"barrier\" ]\n  }, {\n    \"field-id\" : 52,\n    \"names\"
        : [ \"boundary\" ]\n  }, {\n    \"field-id\" : 53,\n    \"names\" : [ \"building\"
        ]\n  }, {\n    \"field-id\" : 54,\n    \"names\" : [ \"craft\" ]\n  }, {\n    \"field-id\"
        : 55,\n    \"names\" : [ \"emergency\" ]\n  }, {\n    \"field-id\" : 56,\n    \"names\"
        : [ \"geological\" ]\n  }, {\n    \"field-id\" : 57,\n    \"names\" : [ \"healthcare\"
        ]\n  }, {\n    \"field-id\" : 58,\n    \"names\" : [ \"highway\" ]\n  }, {\n    \"field-id\"
        : 59,\n    \"names\" : [ \"historic\" ]\n  }, {\n    \"field-id\" : 60,\n    \"names\"
        : [ \"landuse\" ]\n  }, {\n    \"field-id\" : 61,\n    \"names\" : [ \"leisure\"
        ]\n  }, {\n    \"field-id\" : 62,\n    \"names\" : [ \"man_made\" ]\n  },
        {\n    \"field-id\" : 63,\n    \"names\" : [ \"military\" ]\n  }, {\n    \"field-id\"
        : 64,\n    \"names\" : [ \"natural\" ]\n  }, {\n    \"field-id\" : 65,\n    \"names\"
        : [ \"office\" ]\n  }, {\n    \"field-id\" : 66,\n    \"names\" : [ \"place\"
        ]\n  }, {\n    \"field-id\" : 67,\n    \"names\" : [ \"power\" ]\n  }, {\n    \"field-id\"
        : 68,\n    \"names\" : [ \"public_transport\" ]\n  }, {\n    \"field-id\"
        : 69,\n    \"names\" : [ \"railway\" ]\n  }, {\n    \"field-id\" : 70,\n    \"names\"
        : [ \"route\" ]\n  }, {\n    \"field-id\" : 71,\n    \"names\" : [ \"shop\"
        ]\n  }, {\n    \"field-id\" : 72,\n    \"names\" : [ \"sport\" ]\n  }, {\n    \"field-id\"
        : 73,\n    \"names\" : [ \"telecom\" ]\n  }, {\n    \"field-id\" : 74,\n    \"names\"
        : [ \"water\" ]\n  }, {\n    \"field-id\" : 75,\n    \"names\" : [ \"waterway\"
        ]\n  } ]\n}, {\n  \"field-id\" : 14,\n  \"names\" : [ \"area\" ]\n}, {\n  \"field-id\"
        : 15,\n  \"names\" : [ \"area_delta\" ]\n}, {\n  \"field-id\" : 16,\n  \"names\"
        : [ \"length\" ]\n}, {\n  \"field-id\" : 17,\n  \"names\" : [ \"length_delta\"
        ]\n}, {\n  \"field-id\" : 18,\n  \"names\" : [ \"xzcode\" ],\n  \"fields\"
        : [ {\n    \"field-id\" : 76,\n    \"names\" : [ \"level\" ]\n  }, {\n    \"field-id\"
        : 77,\n    \"names\" : [ \"code\" ]\n  } ]\n}, {\n  \"field-id\" : 19,\n  \"names\"
        : [ \"country_iso_a3\" ],\n  \"fields\" : [ {\n    \"field-id\" : 78,\n    \"names\"
        : [ \"element\" ]\n  } ]\n}, {\n  \"field-id\" : 20,\n  \"names\" : [ \"bbox\"
        ],\n  \"fields\" : [ {\n    \"field-id\" : 79,\n    \"names\" : [ \"xmin\"
        ]\n  }, {\n    \"field-id\" : 80,\n    \"names\" : [ \"ymin\" ]\n  }, {\n    \"field-id\"
        : 81,\n    \"names\" : [ \"xmax\" ]\n  }, {\n    \"field-id\" : 82,\n    \"names\"
        : [ \"ymax\" ]\n  } ]\n}, {\n  \"field-id\" : 21,\n  \"names\" : [ \"xmin\"
        ]\n}, {\n  \"field-id\" : 22,\n  \"names\" : [ \"xmax\" ]\n}, {\n  \"field-id\"
        : 23,\n  \"names\" : [ \"ymin\" ]\n}, {\n  \"field-id\" : 24,\n  \"names\"
        : [ \"ymax\" ]\n}, {\n  \"field-id\" : 25,\n  \"names\" : [ \"centroid\" ],\n  \"fields\"
        : [ {\n    \"field-id\" : 83,\n    \"names\" : [ \"x\" ]\n  }, {\n    \"field-id\"
        : 84,\n    \"names\" : [ \"y\" ]\n  } ]\n}, {\n  \"field-id\" : 26,\n  \"names\"
        : [ \"quadkey_z10\" ]\n}, {\n  \"field-id\" : 27,\n  \"names\" : [ \"h3_r5\"
        ]\n}, {\n  \"field-id\" : 28,\n  \"names\" : [ \"geometry_type\" ]\n}, {\n  \"field-id\"
        : 29,\n  \"names\" : [ \"geometry_valid\" ]\n}, {\n  \"field-id\" : 30,\n  \"names\"
        : [ \"geometry\" ]\n} ]","write.parquet.compression-codec":"zstd"},"current-snapshot-id":8900095425402369671,"refs":{"main":{"snapshot-id":8900095425402369671,"type":"branch"}},"snapshots":[{"sequence-number":1,"snapshot-id":8900095425402369671,"timestamp-ms":1725696468364,"summary":{"operation":"append","added-data-files":"1746","added-records":"3616810432","added-files-size":"478010110129","changed-partition-count":"17","total-records":"3616810432","total-files-size":"478010110129","total-data-files":"1746","total-delete-files":"0","total-position-deletes":"0","total-equality-deletes":"0","iceberg-version":"Apache
        Iceberg 1.6.0 (commit 229d8f6fcd109e6c8943ea7cbb41dab746c6d0ed)"},"manifest-list":"s3a://heigit-ohsome-planet/iceberg/geo_sort/contributions/metadata/snap-8900095425402369671-1-b44d8b72-6c9b-4cbe-b5e2-96a49a4d446b.avro","schema-id":0}],"statistics":[],"partition-statistics":[],"snapshot-log":[{"timestamp-ms":1725696468364,"snapshot-id":8900095425402369671}],"metadata-log":[{"timestamp-ms":1725696374233,"metadata-file":"s3a://heigit-ohsome-planet/iceberg/geo_sort/contributions/metadata/00000-11f6addb-ce8c-4899-9f0e-3a7d3b8594ac.metadata.json"},{"timestamp-ms":1725696374378,"metadata-file":"s3a://heigit-ohsome-planet/iceberg/geo_sort/contributions/metadata/00001-d658d518-3142-44f0-aa5b-8779ade50dbc.metadata.json"}]},"config":{}}'
    headers:
      Connection:
      - Keep-Alive
      Content-Encoding:
      - gzip
      Content-Length:
      - '2339'
      Content-Type:
      - application/json
      Date:
      - Fri, 17 Oct 2025 10:18:44 GMT
      Keep-Alive:
      - timeout=5, max=100
      Server:
      - Jetty(9.4.51.v20230217)
      Strict-Transport-Security:
      - max-age=63072000; includeSubdomains;
      Vary:
      - Accept-Encoding,User-Agent
    status:
      code: 200
      message: OK
version: 1
